<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="APCalign">
<title>APCalign • APCalign</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="APCalign">
<meta property="og:description" content="APCalign">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">APCalign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/APCalign.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Data providers</h6>
    <a class="dropdown-item" href="../articles/data-providers.html">APC and APNI</a>
    <h6 class="dropdown-header" data-toc-skip>Data caching</h6>
    <a class="dropdown-item" href="../articles/caching.html">How is APC/APNI stored in APCalign?</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Taxon matching</h6>
    <a class="dropdown-item" href="../articles/taxmatch.html">Our fuzzy matching algorithim</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>APCalign</h1>
            
      
      
      <div class="d-none name"><code>APCalign.Rmd</code></div>
    </div>

    
    
<p>When working with biodiversity data, it is important to verify
taxonomic names with an authoritative list and correct any out-of-date
names. The ‘APCalign’ package simplifies this process by:</p>
<ul>
<li>Accessing up-to-date taxonomic information from the <a href="https://biodiversity.org.au/nsl/services/search/taxonomy" class="external-link">Australian
Plant Census</a> and the <a href="https://biodiversity.org.au/nsl/services/search/names" class="external-link">Australia
Plant Name Index</a>.</li>
<li>Aligning authoritative names to your taxonomic names using our <a href="taxmatch.html">fuzzy matching algorithm</a>
</li>
<li>Updating your taxonomic names in a transparent, reproducible
manner</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>‘APCalign’ is currently not on CRAN. You can install its current
developmental version using</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"traitecoevo/APCalign"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://traitecoevo.github.io/APCalign/">APCalign</a></span><span class="op">)</span></span></code></pre></div>
<p>To demonstrate how to use ‘APCalign’, we will use an example dataset
<code>gbif_lite</code> which is documented in
<code><a href="../reference/gbif_lite.html">?gbif_lite</a></code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">gbif_lite</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 129   7</span></span>
<span></span>
<span><span class="va">gbif_lite</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 129 × 7</span></span>
<span><span class="co">#&gt;   species              infraspecificepithet taxonrank decimalLongitude decimalLatitude scientificname</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                &lt;chr&gt;                &lt;chr&gt;                &lt;dbl&gt;           &lt;dbl&gt; &lt;chr&gt;         </span></span>
<span><span class="co">#&gt; 1 Tetratheca ciliata   &lt;NA&gt;                 SPECIES               145.           -37.4 Tetratheca ci…</span></span>
<span><span class="co">#&gt; 2 Peganum harmala      &lt;NA&gt;                 SPECIES               139.           -33.3 Peganum harma…</span></span>
<span><span class="co">#&gt; 3 Calotis multicaulis  &lt;NA&gt;                 SPECIES               115.           -24.3 Calotis multi…</span></span>
<span><span class="co">#&gt; 4 Leptospermum triner… &lt;NA&gt;                 SPECIES               151.           -34.0 Leptospermum …</span></span>
<span><span class="co">#&gt; 5 Lepidosperma latera… &lt;NA&gt;                 SPECIES               142.           -37.3 Lepidosperma …</span></span>
<span><span class="co">#&gt; 6 Enneapogon polyphyl… &lt;NA&gt;                 SPECIES               129.           -17.8 Enneapogon po…</span></span>
<span><span class="co">#&gt; # ℹ 123 more rows</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: verbatimscientificname &lt;chr&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="retrieve-taxonomic-resources">Retrieve taxonomic resources<a class="anchor" aria-label="anchor" href="#retrieve-taxonomic-resources"></a>
</h2>
<p>The first step is to retrieve the entire APC and APNI name databases
and store them locally as taxonomic resources. We achieve this using
<code><a href="../reference/load_taxonomic_resources.html">load_taxonomic_resources()</a></code>.</p>
<p>There are two versions of the databases that you can retrieve with
the <code>stable_or_current_data</code> argument. Calling:</p>
<ul>
<li>
<code>stable</code> will retrieve the most recent, archived version
of the databases from our <a href="https://github.com/traitecoevo/APCalign/releases" class="external-link">GitHub
releases</a>. This is set as the default option.</li>
<li>
<code>current</code> will retrieve the up-to-date databases directly
from the APC and APNI website.</li>
</ul>
<p>Note that the databases are quite large so the initial retrieval of
<code>stable</code> versions will take a few minutes. Once the taxonomic
resources have been stored locally, subsequent retrievals will take less
time. Retrieving <code>current</code> resources will always take longer
since it is. Check out our <a href="caching.html">Resource Caching</a>
article to learn more about how the APC and APNIC databases are
accessed, stored and retrieved.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Benchmarking the retrieval of `stable` or `current` resources</span></span>
<span><span class="va">stable_start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">stable_resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_taxonomic_resources.html">load_taxonomic_resources</a></span><span class="op">(</span>stable_or_current_data <span class="op">=</span> <span class="st">"stable"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading resources...</span></span>
<span><span class="co">#&gt; Warning: https://github.com/traitecoevo/APCalign/releases/download/0.0.2.9000/apc.parquet had error</span></span>
<span><span class="co">#&gt; code 404</span></span>
<span><span class="co">#&gt; Warning in contentid::resolve(apc_hash, store = TRUE, path = path): No sources found for</span></span>
<span><span class="co">#&gt; hash://sha256/7326ca5e7eb1e115959f840583e25cd4605667b46d8edacc20ccb637f8c6e982</span></span>
<span><span class="co">#&gt; Error: IOError: Failed to open local file 'NA'. Detail: [errno 2] No such file or directory</span></span>
<span><span class="co">#&gt; ...done</span></span>
<span><span class="va">stable_end_time</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">current_start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">current_resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_taxonomic_resources.html">load_taxonomic_resources</a></span><span class="op">(</span>stable_or_current_data <span class="op">=</span> <span class="st">"current"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading resources......done</span></span>
<span><span class="va">current_end_time</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare times</span></span>
<span><span class="va">stable_end_time</span> <span class="op">-</span> <span class="va">stable_start_time</span></span>
<span><span class="co">#&gt; Time difference of 2.50855 secs</span></span>
<span><span class="va">current_end_time</span> <span class="op">-</span> <span class="va">current_start_time</span></span>
<span><span class="co">#&gt; Time difference of 17.48739 secs</span></span></code></pre></div>
<p>For a more reproducible workflow, we recommend specifying the exact
<code>stable</code> version you want to use.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_taxonomic_resources.html">load_taxonomic_resources</a></span><span class="op">(</span>stable_or_current_data <span class="op">=</span> <span class="st">"stable"</span>, version <span class="op">=</span> <span class="st">"0.0.2.9000"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading resources...</span></span>
<span><span class="co">#&gt; Warning: https://github.com/traitecoevo/APCalign/releases/download/0.0.2.9000/apc.parquet had error</span></span>
<span><span class="co">#&gt; code 404</span></span>
<span><span class="co">#&gt; Warning in contentid::resolve(apc_hash, store = TRUE, path = path): No sources found for</span></span>
<span><span class="co">#&gt; hash://sha256/7326ca5e7eb1e115959f840583e25cd4605667b46d8edacc20ccb637f8c6e982</span></span>
<span><span class="co">#&gt; Error: IOError: Failed to open local file 'NA'. Detail: [errno 2] No such file or directory</span></span>
<span><span class="co">#&gt; ...done</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="standardise-plant-taxon-names">Standardise plant taxon names<a class="anchor" aria-label="anchor" href="#standardise-plant-taxon-names"></a>
</h2>
<p>Now we can query our taxonomic names against the taxonomic resources
we just retrieved using <code><a href="../reference/create_taxonomic_update_lookup.html">create_taxonomic_update_lookup()</a></code>.
This is an all-in-one function will:</p>
<ul>
<li>Align your taxonomic names to APNI and APC using our <a href="taxmatch.html">fuzzy matching algorithm</a>
</li>
<li>Update taxonomic names to APC accepted name.</li>
<li>Returns NA for names where a match cannot be found</li>
</ul>
<p>If you would like to learn more about each of these step, take a look
at the section <a href="#closer-look">Closer look at name
standardisation with ‘APCalign’</a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">update_gbif_names</span> <span class="op">&lt;-</span> <span class="va">gbif_lite</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/create_taxonomic_update_lookup.html">create_taxonomic_update_lookup</a></span><span class="op">(</span>resources <span class="op">=</span> <span class="va">resources</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking alignments of 121 taxa</span></span>
<span><span class="co">#&gt;   -&gt; 0 names already matched; 0 names checked but without a match; 121 taxa yet to be checked</span></span>
<span><span class="co">#&gt; Error in `dplyr::mutate()`:</span></span>
<span><span class="co">#&gt; ℹ In argument: `fuzzy_match_genus = fuzzy_match_genera(genus,</span></span>
<span><span class="co">#&gt;   resources$genera_accepted$canonicalName)`.</span></span>
<span><span class="co">#&gt; Caused by error in `purrr::map_chr()` at APCalign/R/match_taxa.R:9:4:</span></span>
<span><span class="co">#&gt; ℹ In index: 1.</span></span>
<span><span class="co">#&gt; Caused by error in `utils::adist()`:</span></span>
<span><span class="co">#&gt; ! object 'resources' not found</span></span>
<span></span>
<span><span class="va">update_gbif_names</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in print(update_gbif_names, n = 6): object 'update_gbif_names' not found</span></span></code></pre></div>
<p>The <code>original_name</code> is the taxon name used in your
original data. The <code>aligned_name</code> is the taxon name we used
to link with the APC to identify any synonyms. The <code>apc_name</code>
is the currently, accepted taxon name used by the Australian Plant
Census.</p>
<p>We recommend joining the output of
<code><a href="../reference/create_taxonomic_update_lookup.html">create_taxonomic_update_lookup()</a></code> back to your original data
so all names</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gbif_lite</span> <span class="op">|&gt;</span> </span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">update_gbif_names</span>,  <span class="co"># Left joining updated taxon names back to original data </span></span>
<span>          by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">species</span> <span class="op">==</span> <span class="va">original_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"name"</span><span class="op">)</span>, <span class="co"># Rearranging naming columns</span></span>
<span>         <span class="va">aligned_reason</span>, <span class="va">infraspecificepithet</span><span class="op">:</span><span class="va">decimalLatitude</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in is.data.frame(y): object 'update_gbif_names' not found</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plant-established-status-across-statesterritories">Plant established status across states/territories<a class="anchor" aria-label="anchor" href="#plant-established-status-across-statesterritories"></a>
</h2>
<p>‘APCalign’ can also provide the state/territory distribution for
established status (native/introduced) from the APC.</p>
<p>We can access the established status data by state/territory using
<code><a href="../reference/create_species_state_origin_matrix.html">create_species_state_origin_matrix()</a></code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieve status data by state/territory </span></span>
<span><span class="va">status_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_species_state_origin_matrix.html">create_species_state_origin_matrix</a></span><span class="op">(</span>resources <span class="op">=</span> <span class="va">resources</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in dplyr::filter(resources$APC, taxonRank == "Species" &amp; taxonomicStatus == : object 'resources' not found</span></span>
<span></span>
<span><span class="va">status_matrix</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in print(status_matrix, n = 6): object 'status_matrix' not found</span></span></code></pre></div>
<p>Here is a breakdown of all possible values for
<code>origin</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Obtain unique values</span></span>
<span><span class="va">status_matrix</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">flatten_chr</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/tabyl.html" class="external-link">tabyl</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in select(status_matrix, -species): object 'status_matrix' not found</span></span></code></pre></div>
<!-- The formal definitions of the various established status can be found at XX.  -->
<p>You can also obtain the breakdown of species by established status
for a particular state/territory using
<code><a href="../reference/state_diversity_counts.html">state_diversity_counts()</a></code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/state_diversity_counts.html">state_diversity_counts</a></span><span class="op">(</span><span class="st">"NSW"</span>, resources <span class="op">=</span> <span class="va">resources</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in dplyr::filter(resources$APC, taxonRank == "Species" &amp; taxonomicStatus == : object 'resources' not found</span></span></code></pre></div>
<p>Using the established status data and state/territory information, we
can check if a plant taxa is a native using
<code><a href="../reference/native_anywhere_in_australia.html">native_anywhere_in_australia()</a></code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_gbif_names</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span>  <span class="co"># Choosing a random species</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">apc_name</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># Extracting this APC accepted name</span></span>
<span>  <span class="fu"><a href="../reference/native_anywhere_in_australia.html">native_anywhere_in_australia</a></span><span class="op">(</span>resources <span class="op">=</span> <span class="va">resources</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in dplyr::filter(resources$APC, taxonRank == "Species" &amp; taxonomicStatus == : object 'resources' not found</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="closer-look">Closer look at name standardisation with ‘APCalign’<a class="anchor" aria-label="anchor" href="#closer-look"></a>
</h2>
<p><code>create_taxonomic_update_lookup</code> is a simple, wrapper,
function for novice users that want to quickly check and standardise
taxon names. For more experienced users, you can take a look at the sub
functions <code><a href="../reference/align_taxa.html">align_taxa()</a></code> and <code><a href="../reference/update_taxonomy.html">update_taxonomy()</a></code>
to see how taxon names are processed, aligned and updated.</p>
<p><img src="../reference/figures/standardise_taxonomy_workflow.png"></p>
<div class="section level3">
<h3 id="aligning-names-to-apni-and-apc">Aligning names to APNI and APC<a class="anchor" aria-label="anchor" href="#aligning-names-to-apni-and-apc"></a>
</h3>
<p>This function will:</p>
<ul>
<li>Clean up your taxonomic names
<!-- (Getting rid of trailing whitespaces, case correction) -->
</li>
<li>Find best alignment with APNI to your taxonomic name using our <a href="taxmatch.html">fuzzy matching algorithm</a>
</li>
</ul>
<p>You can control the degree of fuzzy matching using the arguments
<code>max_distance_abs</code> and <code>max_distance_rel</code></p>
<p>Note that the <code>aligned_name</code> may not be current. This does
the best possible effort to match phrase names and subspecific taxa
which often have alternative formatting. This function also searches for
small spelling or gender mistakes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">aligned_gbif_taxa</span> <span class="op">&lt;-</span> <span class="va">gbif_lite</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/align_taxa.html">align_taxa</a></span><span class="op">(</span>resources <span class="op">=</span> <span class="va">resources</span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking alignments of 121 taxa</span></span>
<span><span class="co">#&gt;   -&gt; 0 names already matched; 0 names checked but without a match; 121 taxa yet to be checked</span></span>
<span><span class="co">#&gt; Error in `dplyr::mutate()`:</span></span>
<span><span class="co">#&gt; ℹ In argument: `fuzzy_match_genus = fuzzy_match_genera(genus,</span></span>
<span><span class="co">#&gt;   resources$genera_accepted$canonicalName)`.</span></span>
<span><span class="co">#&gt; Caused by error in `purrr::map_chr()` at APCalign/R/match_taxa.R:9:4:</span></span>
<span><span class="co">#&gt; ℹ In index: 1.</span></span>
<span><span class="co">#&gt; Caused by error in `utils::adist()`:</span></span>
<span><span class="co">#&gt; ! object 'resources' not found</span></span>
<span></span>
<span><span class="va">aligned_gbif_taxa</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in print(aligned_gbif_taxa, n = 6): object 'aligned_gbif_taxa' not found</span></span></code></pre></div>
<p>For every <code>aligned_name</code>, <code><a href="../reference/align_taxa.html">align_taxa()</a></code> will
provide a <code>aligned_reason</code> which you can review as a table of
counts:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">aligned_gbif_taxa</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">aligned_reason</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://sfirke.github.io/janitor/reference/tabyl.html" class="external-link">tabyl</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Error in pull(aligned_gbif_taxa, aligned_reason): object 'aligned_gbif_taxa' not found</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="update-taxonomic-names-to-alignments">Update taxonomic names to alignments<a class="anchor" aria-label="anchor" href="#update-taxonomic-names-to-alignments"></a>
</h3>
<p><code><a href="../reference/update_taxonomy.html">update_taxonomy()</a></code> will update APNI taxa to specified (or
current) version of APC. It will use the general synonymy published by
the APC to attempt to sync the taxon names to a specific list. The
function will also add other relevant taxonomy columns in the output</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">updated_gbif_taxa</span> <span class="op">&lt;-</span> <span class="va">aligned_gbif_taxa</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">aligned_name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/update_taxonomy.html">update_taxonomy</a></span><span class="op">(</span>resources <span class="op">=</span> <span class="va">resources</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in pull(aligned_gbif_taxa, aligned_name): object 'aligned_gbif_taxa' not found</span></span>
<span></span>
<span><span class="va">updated_gbif_taxa</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in print(updated_gbif_taxa, n = 6): object 'updated_gbif_taxa' not found</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel Falster.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
