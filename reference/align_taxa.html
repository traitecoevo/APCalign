<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Align Australian plant scientific names to the APC or APNI — align_taxa • APCalign</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Align Australian plant scientific names to the APC or APNI — align_taxa"><meta name="description" content="For a list of Australian plant names, find taxonomic or scientific name
alignments to the APC or APNI through standardizing formatting and fixing
spelling errors.
Usage case: Users will run this function if they wish to see the details
of the matching algorithms, the many output columns that the matching
function compares to as it seeks the best alignment. They may also select
this function if they want to adjust the “fuzziness” level for fuzzy
matches, options not allowed in create_taxonomic_update_lookup. This
function is the first half of create_taxonomic_update_lookup."><meta property="og:description" content="For a list of Australian plant names, find taxonomic or scientific name
alignments to the APC or APNI through standardizing formatting and fixing
spelling errors.
Usage case: Users will run this function if they wish to see the details
of the matching algorithms, the many output columns that the matching
function compares to as it seeks the best alignment. They may also select
this function if they want to adjust the “fuzziness” level for fuzzy
matches, options not allowed in create_taxonomic_update_lookup. This
function is the first half of create_taxonomic_update_lookup."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">APCalign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/APCalign.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/articles/data-providers.html">Data sources (APC &amp; APNI)</a></li>
    <li><a class="dropdown-item" href="../articles/updating-taxon-names.html">Taxon matching</a></li>
    <li><a class="dropdown-item" href="../articles/reproducibility.html">Using APC versions for reproducibility</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/traitecoevo/APCalign/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Align Australian plant scientific names to the APC or APNI</h1>
      <small class="dont-index">Source: <a href="https://github.com/traitecoevo/APCalign/blob/master/R/align_taxa.R" class="external-link"><code>R/align_taxa.R</code></a></small>
      <div class="d-none name"><code>align_taxa.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For a list of Australian plant names, find taxonomic or scientific name
alignments to the APC or APNI through standardizing formatting and fixing
spelling errors.</p>
<p>Usage case: Users will run this function if they wish to see the details
of the matching algorithms, the many output columns that the matching
function compares to as it seeks the best alignment. They may also select
this function if they want to adjust the “fuzziness” level for fuzzy
matches, options not allowed in create_taxonomic_update_lookup. This
function is the first half of create_taxonomic_update_lookup.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">align_taxa</span><span class="op">(</span></span>
<span>  <span class="va">original_name</span>,</span>
<span>  output <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  full <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resources <span class="op">=</span> <span class="fu"><a href="load_taxonomic_resources.html">load_taxonomic_resources</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  fuzzy_abs_dist <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  fuzzy_rel_dist <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  fuzzy_matches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  imprecise_fuzzy_matches <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  APNI_matches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  identifier <span class="op">=</span> <span class="cn">NA_character_</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-original-name">original_name<a class="anchor" aria-label="anchor" href="#arg-original-name"></a></dt>
<dd><p>A list of names to query for taxonomic alignments.</p></dd>


<dt id="arg-output">output<a class="anchor" aria-label="anchor" href="#arg-output"></a></dt>
<dd><p>(optional) The name of the file to save the results to.</p></dd>


<dt id="arg-full">full<a class="anchor" aria-label="anchor" href="#arg-full"></a></dt>
<dd><p>Parameter to determine how many columns are output</p></dd>


<dt id="arg-resources">resources<a class="anchor" aria-label="anchor" href="#arg-resources"></a></dt>
<dd><p>the taxonomic resources used to align the taxa names.
Loading this can be slow, so call <code><a href="load_taxonomic_resources.html">load_taxonomic_resources</a></code>
separately to greatly speed this function up and pass the resources in.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical to indicate whether to display messages while
aligning taxa.</p></dd>


<dt id="arg-fuzzy-abs-dist">fuzzy_abs_dist<a class="anchor" aria-label="anchor" href="#arg-fuzzy-abs-dist"></a></dt>
<dd><p>The number of characters allowed to be different for a
fuzzy match.</p></dd>


<dt id="arg-fuzzy-rel-dist">fuzzy_rel_dist<a class="anchor" aria-label="anchor" href="#arg-fuzzy-rel-dist"></a></dt>
<dd><p>The proportion of characters allowed to be different
for a fuzzy match.</p></dd>


<dt id="arg-fuzzy-matches">fuzzy_matches<a class="anchor" aria-label="anchor" href="#arg-fuzzy-matches"></a></dt>
<dd><p>Fuzzy matches are turned on as a default.
The relative and absolute distances allowed for fuzzy matches to species and
infraspecific taxon names are defined by the parameters <code>fuzzy_abs_dist</code>
and <code>fuzzy_rel_dist</code></p></dd>


<dt id="arg-imprecise-fuzzy-matches">imprecise_fuzzy_matches<a class="anchor" aria-label="anchor" href="#arg-imprecise-fuzzy-matches"></a></dt>
<dd><p>Imprecise fuzzy matches uses the
fuzzy matching function with lenient levels set (absolute distance of
5 characters; relative distance = 0.25).
It offers a way to get a wider range of possible names, possibly
corresponding to very distant spelling mistakes.
This is FALSE as default and all outputs should be checked as it often
makes erroneous matches.</p></dd>


<dt id="arg-apni-matches">APNI_matches<a class="anchor" aria-label="anchor" href="#arg-apni-matches"></a></dt>
<dd><p>Name matches to the APNI (Australian Plant Names Index)
are turned on as a default.</p></dd>


<dt id="arg-identifier">identifier<a class="anchor" aria-label="anchor" href="#arg-identifier"></a></dt>
<dd><p>A dataset, location or other identifier,
which defaults to NA.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with columns that include original_name, aligned_name,
taxonomic_dataset, taxon_rank, aligned_reason, alignment_code.</p><ul><li><p>original_name: the original plant name input.</p></li>
<li><p>aligned_name: the original plant name after the function standardise_names
has standardised the syntax of infraspecific taxon designations.</p></li>
<li><p>taxonomic_dataset: the source of the aligned names (APC or APNI).</p></li>
<li><p>taxon_rank: the taxonomic rank of the aligned name.</p></li>
<li><p>aligned_reason: the explanation of a specific taxon name alignment
(from an original name to an aligned name).</p></li>
<li><p>alignment_code: a code that accompanies the aligned_reason, indicating the
relative sequence of the match during the alignment process.</p></li>
<li><p>cleaned_name: original name with punctuation and infraspecific taxon
designation terms standardised by the function standardise_names;
streamlines exact matches.</p></li>
<li><p>stripped_name: cleaned name with punctuation and infraspecific taxon
designation terms removed by the function strip_names;
improves fuzzy matches.</p></li>
<li><p>stripped_name2: cleaned name with punctuation, infraspecific taxon
designation terms, and other filler words removed by
the function <code>strip_names_extra</code>;
required for matches to <code>first two word</code> and <code>first three words</code>.</p></li>
<li><p>trinomial: the first three words in <code>stripped_name2</code>, required for matches
that ignore all other text in the original_name;
improves phrase name matches.</p></li>
<li><p>binomial: the first two words in <code>stripped_name2</code>, required for matches
that ignore all other text in the original_name;
improves phrase name matches.</p></li>
<li><p>genus: the first two words in <code>cleaned_name</code>;
required for genus-rank matches and reprocessing of genus-rank names.</p></li>
<li><p>fuzzy_match_genus: fuzzy match of genus column to best match among
APC-accepted names;
required for fuzzy matches of genus-rank names.</p></li>
<li><p>fuzzy_match_genus_synonym: fuzzy match of genus column to best match among
APC-synonymous names, only considering different matches to those documented
under APC-accepted genera; required for fuzzy matches of genus-rank names.</p></li>
<li><p>fuzzy_match_genus_APNI: fuzzy match of genus column to best match among
APNI names, only considering different matches to those documented under
APC-accepted and APC-known genera; required for fuzzy matches of
genus-rank names.</p></li>
<li><p>fuzzy_match_family: fuzzy match of genus column to best match among
APC-accepted family names; required for fuzzy matches of family-rank names.</p></li>
<li><p>fuzzy_match_family_synonym: fuzzy match of genus column to best match
among APC-synonymous family names; required for fuzzy matches of
family-rank names.</p></li>
<li><p>fuzzy_match_cleaned_APC: fuzzy match of stripped_name to APC-accepted
names; created for yet-to-be-aligned names at the match step 05a
in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_cleaned_APC_synonym: fuzzy match of stripped_name to
APC-synonymous names; created for yet-to-be-aligned names at the
match step 05b in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_cleaned_APC_imprecise: imprecise fuzzy match of stripped_name
to APC-accepted names; created for yet-to-be-aligned names at the
match step 07a in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_cleaned_APC_synonym_imprecise: imprecise fuzzy match of
stripped_name to APC-accepted names; created for yet-to-be-aligned names
at the match step 07b in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_binomial: fuzzy match of binomial column to best match among
APC-accepted names; created for yet-to-be-aligned names at
match step 10c in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_binomial_APC_synonym: fuzzy match of binomial column to best
match among APC-synonymous names; created for yet-to-be-aligned names at
match step 10d in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_trinomial: fuzzy match of trinomial column to best match
among APC-accepted names; created for yet-to-be-aligned names at
match step 09c in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_trinomial_synonym: fuzzy match of trinomial column to best
match among APC-synonymous names; created for yet-to-be-aligned names at
match step 09d in the function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_cleaned_APNI: fuzzy match of stripped_name to APNI names;
created for yet-to-be-aligned names at the match step 11a in the
function <code>match_taxa</code>.</p></li>
<li><p>fuzzy_match_cleaned_APNI_imprecise: imprecise fuzzy match of
stripped_name to APNI names; created for yet-to-be-aligned names
at the match step 11b in the function <code>match_taxa</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<ul><li><p>This function finds taxonomic alignments in APC or scientific name
alignments in APNI.</p></li>
<li><p>It uses the internal function <code>match_taxa</code> to attempt to match input
strings to taxon names in the APC/APNI.</p></li>
<li><p>It sequentially searches for matches against more than 20 different string
patterns, prioritising exact matches (to accepted names as well as
synonyms, orthographic variants) over fuzzy matches.</p></li>
<li><p>It prioritises matches to taxa in the APC over names in the APNI.</p></li>
<li><p>It identifies string patterns in input names that suggest a name can only
be aligned to a genus (hybrids that are not in the APC/APNI; graded species;
taxa not identified to species), and indicates these names only have a
genus-rank match.</p></li>
</ul><p>Notes:</p><ul><li><p>If you will be running the function APCalign::create_taxonomic_update_lookup
many times, it is best to load the taxonomic resources separately using
resources &lt;- load_taxonomic_resources(), then add the argument
resources = resources</p></li>
<li><p>The name Banksia cerrata does not align as the fuzzy matching algorithm
does not allow the first letter of the genus and species epithet to change.</p></li>
<li><p>With this function you have the option of changing the fuzzy matching
parameters. The defaults, with fuzzy matches only allowing changes of 3
(or fewer) characters AND 20% (or less) of characters has been carefully
calibrated to catch just about all typos, but very, very rarely mis-align
a name. If you wish to introduce less conservative fuzzy matching it is
recommended you manually check the aligned names.</p></li>
<li><p>It is recommended that you begin with imprecise_fuzzy_matches = FALSE (the
default), as quite a few of the less precise fuzzy matches are likely to be
erroneous. This argument should be turned on only if you plan to check all
alignments manually.</p></li>
<li><p>The argument identifier allows you to add a fix text string to all genus-
and family- level names, such as identifier = "Royal NP" would return "Acacia
sp. [Royal NP]".</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="load_taxonomic_resources.html">load_taxonomic_resources</a></code></p>
<p>Other taxonomic alignment functions:
<code><a href="create_taxonomic_update_lookup.html">create_taxonomic_update_lookup</a>()</code>,
<code><a href="update_taxonomy.html">update_taxonomy</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">resources</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_taxonomic_resources.html">load_taxonomic_resources</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Downloading...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> File downloaded successfully.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> File downloaded successfully.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading resources into memory...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================================================================================================</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ...done</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example 1</span></span></span>
<span class="r-in"><span><span class="fu">align_taxa</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Poa annua"</span>, <span class="st">"Abies alba"</span><span class="op">)</span>, resources<span class="op">=</span><span class="va">resources</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking alignments of 2 taxa</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -&gt; of these <span style="color: #0000BB;">1</span> names have a perfect match to a scientific name in the APC. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       Alignments being sought for remaining names.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   original_name cleaned_name aligned_name taxonomic_dataset taxon_rank</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Poa annua     Poa annua    Poa annua    APC               species   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Abies alba    Abies alba   <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>                <span style="color: #BB0000;">NA</span>        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2 more variables: aligned_reason &lt;chr&gt;, alignment_code &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example 2</span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Banksia serrata"</span>, <span class="st">"Banksia serrate"</span>, <span class="st">"Banksia cerrata"</span>, </span></span>
<span class="r-in"><span><span class="st">"Banksia serrrrata"</span>, <span class="st">"Dryandra sp."</span>, <span class="st">"Banksia big red flowers"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aligned_taxa</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">APCalign</span><span class="fu">::</span><span class="fu">align_taxa</span><span class="op">(</span></span></span>
<span class="r-in"><span>    original_name <span class="op">=</span> <span class="va">input</span>,</span></span>
<span class="r-in"><span>    identifier <span class="op">=</span> <span class="st">"APCalign test"</span>,</span></span>
<span class="r-in"><span>    full <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    resources<span class="op">=</span><span class="va">resources</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> </span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking alignments of 6 taxa</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   -&gt; of these <span style="color: #0000BB;">1</span> names have a perfect match to a scientific name in the APC. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       Alignments being sought for remaining names.</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel Falster, Elizabeth Wenk, Will Cornwell, Fonti Kar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

